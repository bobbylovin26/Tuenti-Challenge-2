The execution of the submit was halted because at first I was using a bruteforce algorithm.
Then, I thought how to optimize it and ended with this. Then I submitted, < 5 secs :D